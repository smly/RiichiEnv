grp:
  train_data:
    - /data/workspace/riichienv/datasets/train_grp.pq
    - /data/workspace/riichienv/datasets/train_grp_2024.pq
  val_data: /data/workspace/riichienv/datasets/val_grp.pq
  output: /data/workspace/riichienv/baseline/grp_model.pth
  device: cuda
  batch_size: 128
  num_workers: 12
  num_epochs: 10
  lr: 5e-4
  input_dim: 20

cql:
  data_glob: "/data/mjsoul/mahjong_game_record_4p_thr_202[45]*/*.bin.xz"
  grp_model: /data/workspace/riichienv/baseline/grp_model.pth
  output: /data/workspace/riichienv/baseline/cql_model.pth
  device: cuda
  batch_size: 128
  lr: 5e-4
  alpha: 0.1
  gamma: 0.97
  num_epochs: 10
  num_workers: 12
  limit: 500000  # 500k samples
  pts_weight: [10.0, 4.0, -4.0, -10.0]
  wandb_entity: smly
  wandb_project: riichienv-offline
  model_class: riichienv_ml.models.cql_model.QNetwork
  dataset_class: riichienv_ml.data.cql_dataset.MCDataset
  model:
    in_channels: 74
    num_blocks: 8
    conv_channels: 128
    fc_dim: 256
    num_actions: 82

online:
  algorithm: ppo
  load_model: /data/workspace/riichienv/baseline/cql_model.pth
  device: cuda
  model_class: riichienv_ml.models.actor_critic.ActorCriticNetwork
  encoder_class: riichienv_ml.data.cql_dataset.ObservationEncoder
  num_workers: 12
  num_steps: 2000
  lr: 1e-4
  gamma: 0.97
  # PPO params
  ppo_clip: 0.1
  ppo_epochs: 4
  gae_lambda: 0.95
  entropy_coef: 0.001
  value_coef: 0.5
  # Common
  eval_interval: 10
  worker_device: cuda
  gpu_per_worker: 0.08
  num_envs_per_worker: 16
  checkpoint_dir: /data/workspace/riichienv/ppo_baseline/checkpoints
  wandb_project: riichienv-online
  model:
    in_channels: 74
    num_blocks: 8
    conv_channels: 128
    fc_dim: 256
    num_actions: 82
